<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Getting started with neyral networks | A Minimal Book Example</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Getting started with neyral networks | A Minimal Book Example" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Getting started with neyral networks | A Minimal Book Example" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Yihui Xie" />


<meta name="date" content="2020-04-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="transfer-learning-with-tensorflow-hub.html"/>
<link rel="next" href="applications.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html"><i class="fa fa-check"></i><b>3</b> Transfer learning with TensorFlow Hub</a><ul>
<li class="chapter" data-level="3.1" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#knowledge"><i class="fa fa-check"></i><b>3.1</b> Knowledge</a><ul>
<li class="chapter" data-level="3.1.1" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#what-is-transfer-learning"><i class="fa fa-check"></i><b>3.1.1</b> What is Transfer Learning</a></li>
<li class="chapter" data-level="3.1.2" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#what-is-tensforflow-hub"><i class="fa fa-check"></i><b>3.1.2</b> What is TensforFlow Hub</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#application"><i class="fa fa-check"></i><b>3.2</b> Application</a><ul>
<li class="chapter" data-level="3.2.1" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#imagenet-classifier"><i class="fa fa-check"></i><b>3.2.1</b> ImageNet classifier</a></li>
<li class="chapter" data-level="3.2.2" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#transfer-learning"><i class="fa fa-check"></i><b>3.2.2</b> Transfer learning</a></li>
<li class="chapter" data-level="3.2.3" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#run-the-classifier-on-a-batch-of-images"><i class="fa fa-check"></i><b>3.2.3</b> Run the classifier on a batch of images</a></li>
<li class="chapter" data-level="3.2.4" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#download-a-headless-model"><i class="fa fa-check"></i><b>3.2.4</b> Download a headless model</a></li>
<li class="chapter" data-level="3.2.5" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#attach-a-classification-head"><i class="fa fa-check"></i><b>3.2.5</b> Attach a classification head</a></li>
<li class="chapter" data-level="3.2.6" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#train-the-model"><i class="fa fa-check"></i><b>3.2.6</b> Train the model</a></li>
<li class="chapter" data-level="3.2.7" data-path="transfer-learning-with-tensorflow-hub.html"><a href="transfer-learning-with-tensorflow-hub.html#export-the-model"><i class="fa fa-check"></i><b>3.2.7</b> Export the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="getting-started-with-neyral-networks.html"><a href="getting-started-with-neyral-networks.html"><i class="fa fa-check"></i><b>4</b> Getting started with neyral networks</a><ul>
<li class="chapter" data-level="4.1" data-path="getting-started-with-neyral-networks.html"><a href="getting-started-with-neyral-networks.html#structure-of-neural-network"><i class="fa fa-check"></i><b>4.1</b> Structure of neural network</a><ul>
<li class="chapter" data-level="4.1.1" data-path="getting-started-with-neyral-networks.html"><a href="getting-started-with-neyral-networks.html#layers"><i class="fa fa-check"></i><b>4.1.1</b> Layers</a></li>
<li class="chapter" data-level="4.1.2" data-path="getting-started-with-neyral-networks.html"><a href="getting-started-with-neyral-networks.html#loss-functions-and-optimizers"><i class="fa fa-check"></i><b>4.1.2</b> Loss functions and optimizers</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="getting-started-with-neyral-networks.html"><a href="getting-started-with-neyral-networks.html#introduction-to-keras"><i class="fa fa-check"></i><b>4.2</b> Introduction to Keras</a><ul>
<li class="chapter" data-level="4.2.1" data-path="getting-started-with-neyral-networks.html"><a href="getting-started-with-neyral-networks.html#istalling-keras"><i class="fa fa-check"></i><b>4.2.1</b> Istalling keras</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a><ul>
<li class="chapter" data-level="5.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>5.1</b> Example one</a></li>
<li class="chapter" data-level="5.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>5.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Book Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="getting-started-with-neyral-networks" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Getting started with neyral networks</h1>
<div id="structure-of-neural-network" class="section level2">
<h2><span class="header-section-number">4.1</span> Structure of neural network</h2>
<p>Training a neural network concerns these objects: layers, input data and corresponding targets, loss function and optimizer.
The network is composed of layers stacked together, maps the input data to predictions. The loss function is used to compare the predictions to the targes and generats a <em>loss value</em> (difference between perdicted and expected values or classes). Then, an <em>optimizer</em> is used used to minimize the loss value by updating the network’s weights.</p>
<div class="figure">
<img src="images/03fig01.jpg" alt="Neural network structure (source:https://livebook.manning.com/book/deep-learning-with-r/chapter-3/19)" />
<p class="caption">Neural network structure (source:<a href="https://livebook.manning.com/book/deep-learning-with-r/chapter-3/19" class="uri">https://livebook.manning.com/book/deep-learning-with-r/chapter-3/19</a>)</p>
</div>
<div id="layers" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Layers</h3>
<p>The layers cnsists on data-processing modules that take as input one or more tensors and generates as outputs one or more tensors. The layers conrain the <em>learned weights</em> taht represent the network’s knowledge.
The layers’ types depend on the data types used as input:
- <em>Densly connecte (fully connected)</em> layers: they are used for <code>vector</code> data taht are stored in 2D tensors of shape <code>(samples, features)</code>
- <em>Recurrent</em> layers: they are used for <code>sequence</code> data that are stred in 3D tensors of shape <code>samples, timsteps, features</code>
- <em>Convolution</em> layers: they are used for <code>ìmage</code> data, taht are stored in 4D tensors</p>
<p>Building deep-learning model in Keras is done by stacking compatible layers together. To respect layer compatibilty, every layer only accept input tensors with a specific shape.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">layer =<span class="st"> </span><span class="kw">layer_dense</span>(<span class="dt">units =</span> <span class="dv">32</span>, <span class="dt">input_shape =</span> <span class="kw">c</span>(<span class="dv">784</span>))</a></code></pre></div>
<p>In this example, we are creating a layer that only accept as input 2D tensors where the first dimension is 784. This layer will return a tensor where the first dimension has been transformed to be 32. Then, this layer can only be connected to a layer taht expects as 32-dimensional vector as input. In keras, the layers we add to our models are automatically built to match the shape of the incoming mayer.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">model =<span class="st"> </span><span class="kw">keras_model_sequential</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="st">  </span><span class="kw">layer_dense</span>(<span class="dt">units =</span> <span class="dv">32</span>, <span class="dt">input_shape =</span> <span class="kw">c</span>(<span class="dv">784</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">  </span><span class="kw">layer_dense</span>(<span class="dt">units =</span> <span class="dv">32</span>)</a></code></pre></div>
<p>SO here we didn’t specify the input shape of the second layer. It was automatically inferred based on the shape of the previous layer (32).</p>
</div>
<div id="loss-functions-and-optimizers" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Loss functions and optimizers</h3>
<p>Once the network layers architectue is defined, we have specify two elements:
- <em>loss function</em>: It represents the quantity that we want to minimize during the training phase.
- <em>Optimizer</em>: It represnts the method used by the network to update the weight based on loss function. It consists on implementing a specific variant of stochastic graient descent optimization.</p>
<p>We can have a network with multiple loss funtions (when the network ghave multiple outpus). Since the gradient-descent process need to be based on a sigle loss value, all loasses values have to be combined i a single measure (by averaging for example).</p>
<p>It is important to select the appropriate loss function depending in the learning problem. There are some guidlines we can follow for common situations:</p>
<ul>
<li>We use <em>binary crossentropy</em> for a Two-class classification problem</li>
<li>We use <em>categorical crossentropy</em> for a Two-class classification problem</li>
<li>we use the <em>mean-squared error</em> for a regression problem</li>
</ul>
</div>
</div>
<div id="introduction-to-keras" class="section level2">
<h2><span class="header-section-number">4.2</span> Introduction to Keras</h2>
<p>Keras is library for developing deep learning models. It dosen’t handle low-level operations such as tensor manipulation. But it relies on specialized tensor libraries as backend engine such as TensorFlown Theano and Mirosoft Cognitive Toolkit (CNTK).
Via TensorFlow, Keras is able to run on both CPUs and GPUs. When running on CPU, TensorFlow is itself wrapping a low-lvel library for tensor operations called Eigen. On GPU, TensorFlow wraps a library called NIVIDIA CUDA Neural Network library (cuDNN).</p>
<div id="istalling-keras" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Istalling keras</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># Installing keras package</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">install.packages</span>(<span class="st">&quot;keras&quot;</span>)</a>
<a class="sourceLine" id="cb29-3" title="3"><span class="co"># Install the core keras library and TensorFlow</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="kw">library</span>(keras)</a>
<a class="sourceLine" id="cb29-5" title="5"><span class="kw">install_keras</span>()</a></code></pre></div>
<p>This installation provide us with a default CPU-based installation of keras and TensoFlow.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="transfer-learning-with-tensorflow-hub.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="applications.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DeepLearning-ComputerVision.pdf", "DeepLearning-ComputerVision.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
